2020-08-24 09:01:58.691 -04:00 [INF] Starting host...
2020-08-24 09:02:02.646 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-24 09:02:03.531 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-24 09:02:03.739 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-24 09:02:03.817 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-24 09:02:04.365 -04:00 [INF] Loading project configs from Configs ...
2020-08-24 09:02:04.376 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-24 09:02:04.378 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.014 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.027 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.340 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.347 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.373 -04:00 [INF] 		Application record found for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.374 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.399 -04:00 [INF] 		Role Admin record found for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.401 -04:00 [INF] 		Role User record found for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.402 -04:00 [INF] 		Role Readonly record found for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.403 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-24 09:02:05.404 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-24 09:02:05.417 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-24 09:02:05.418 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-24 09:02:05.451 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-24 09:02:05.452 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-24 09:02:05.474 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-24 09:02:05.483 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-24 09:02:05.486 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-24 09:02:05.487 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-24 09:02:05.490 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-24 09:02:05.491 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-24 09:02:05.495 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-24 09:02:05.498 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-24 09:02:05.500 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-24 09:02:05.501 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-24 09:02:05.504 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-24 09:02:05.505 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-24 09:02:05.508 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-24 09:02:05.773 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-24 09:02:05.803 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-24 09:05:18.954 -04:00 [INF] Starting host...
2020-08-24 09:05:20.541 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-24 09:05:20.689 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-24 09:05:20.851 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-24 09:05:21.383 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-24 09:05:21.386 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-24 09:05:21.387 -04:00 [INF] Hosting environment: Development
2020-08-24 09:05:21.388 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 07:53:50.931 -04:00 [INF] Starting host...
2020-08-26 07:53:52.267 -04:00 [INF] Migrating Database...
2020-08-26 07:53:53.243 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 07:53:53.706 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:53:53.772 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 07:53:53.803 -04:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 07:54:04.113 -04:00 [INF] Executed DbCommand (272ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 07:54:04.184 -04:00 [INF] Executed DbCommand (68ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 07:54:04.193 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:04.336 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 07:54:04.340 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:04.366 -04:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 07:54:04.376 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 07:54:04.417 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 07:54:04.549 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 07:54:04.555 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 07:54:04.566 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 07:54:04.577 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 07:54:04.585 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.590 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.599 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.607 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.612 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.620 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.627 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.633 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.641 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.649 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.655 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.661 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.670 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.675 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.684 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.694 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.705 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:04.712 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 07:54:04.717 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 07:54:04.721 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 07:54:04.724 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 07:54:04.728 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 07:54:04.734 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 07:54:04.738 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 07:54:04.743 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 07:54:04.746 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 07:54:04.751 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 07:54:04.754 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 07:54:04.757 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 07:54:04.764 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 07:54:04.770 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 07:54:04.775 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 07:54:04.781 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 07:54:04.786 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 07:54:04.791 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 07:54:04.794 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 07:54:04.798 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 07:54:04.802 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 07:54:04.807 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 07:54:04.850 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 07:54:04.855 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:04.858 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 07:54:04.863 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:04.866 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 07:54:04.888 -04:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 07:54:04.905 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 07:54:04.927 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 07:54:04.947 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 07:54:04.967 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 07:54:04.977 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 07:54:04.991 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 07:54:05.000 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 07:54:05.004 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 07:54:05.007 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 07:54:05.178 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 07:54:05.183 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:05.187 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 07:54:05.191 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 07:54:05.194 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 07:54:05.201 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 07:54:05.204 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 07:54:05.300 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 07:54:05.304 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 07:54:05.308 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 07:54:05.318 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 07:54:05.325 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 07:54:05.335 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 07:54:05.347 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:05.353 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:05.361 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:05.370 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:05.378 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 07:54:05.387 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 07:54:05.391 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 07:54:05.395 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 07:54:05.400 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 07:54:05.403 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 07:54:05.409 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 07:54:05.412 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 07:54:05.419 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 07:54:05.425 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 07:54:05.440 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 07:54:05.448 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 07:54:05.454 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 07:54:05.459 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 07:54:05.470 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 07:54:05.475 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 07:54:05.482 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 07:54:05.488 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 07:54:05.494 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 07:54:05.497 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 07:54:05.502 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 07:54:05.505 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 07:54:05.512 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
				INNER JOIN dbo.AspNetUserRoles ur
					ON ur.UserId = u.Id
				INNER JOIN dbo.AspNetRoles r
					ON ur.RoleId = r.Id
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 07:54:05.529 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 07:54:05.548 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 07:54:05.601 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 07:54:05.729 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 07:54:05.795 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 07:54:06.143 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 07:54:06.572 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 07:54:06.580 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 07:54:06.747 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 07:54:06.752 -04:00 [INF] 	Loading Apis for DbView ...
2020-08-26 07:54:06.755 -04:00 [INF] 		Loading  ...
2020-08-26 07:54:06.867 -04:00 [INF] 		Loading  ...
2020-08-26 07:54:06.929 -04:00 [FTL] Host terminated unexpectedly.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'AspNetIdentityServer.dbo.ApiResources'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:c55747da-2986-476a-9399-a23e61aba1f0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(DbContext _, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at EDennis.AspNetIdentityServer.Program.LoadConfigs(IEnumerable`1 projects, ConfigurationDbContext cContext, DomainIdentityDbContext diContext) in C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer\Program.cs:line 242
   at EDennis.AspNetIdentityServer.Program.RunWithConfigs(IHost host, IEnumerable`1 projects, Boolean dump, Boolean commit) in C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer\Program.cs:line 88
   at EDennis.AspNetIdentityServer.Program.Main(String[] args) in C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer\Program.cs:line 65
2020-08-26 08:01:17.895 -04:00 [INF] Starting host...
2020-08-26 08:01:19.264 -04:00 [INF] Migrating Database...
2020-08-26 08:01:20.250 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:01:20.722 -04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:20.788 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:01:20.820 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:01:31.147 -04:00 [INF] Executed DbCommand (284ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:01:31.229 -04:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:01:31.242 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:31.386 -04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:01:31.391 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:31.420 -04:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:01:31.433 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:01:31.478 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:01:31.616 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:01:31.623 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:01:31.635 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:01:31.647 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:01:31.658 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.666 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.675 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.686 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.694 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.704 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.716 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.725 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.733 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.740 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.753 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.762 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.772 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.778 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.787 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.797 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.808 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:31.817 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:01:31.821 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:01:31.827 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:01:31.831 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:01:31.838 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:01:31.841 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:01:31.847 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:01:31.851 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:01:31.856 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:01:31.860 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:01:31.863 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:01:31.871 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:01:31.877 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:01:31.884 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:01:31.893 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:01:31.901 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:01:31.940 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:01:31.953 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:01:31.966 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:01:31.977 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:01:31.990 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:01:32.008 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:01:32.055 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:01:32.058 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:32.061 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:01:32.067 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:32.070 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:01:32.076 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:01:32.087 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:01:32.104 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:01:32.111 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:01:32.118 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:01:32.125 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:01:32.128 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:01:32.134 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:01:32.138 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:01:32.141 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:01:32.307 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:01:32.312 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:32.317 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:01:32.324 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:01:32.327 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:01:32.340 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:01:32.345 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:01:32.444 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:01:32.449 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:01:32.454 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:01:32.462 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:01:32.470 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:01:32.476 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:01:32.486 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:32.497 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:32.507 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:32.515 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:32.522 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:01:32.533 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:01:32.536 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:01:32.544 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:01:32.549 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:01:32.554 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:01:32.559 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:01:32.565 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:01:32.574 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:01:32.584 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:01:32.605 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:01:32.619 -04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:01:32.630 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:01:32.643 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:01:32.653 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:01:32.658 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:01:32.666 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:01:32.673 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:01:32.678 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:01:32.682 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:01:32.687 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:01:32.691 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:01:32.699 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
				INNER JOIN dbo.AspNetUserRoles ur
					ON ur.UserId = u.Id
				INNER JOIN dbo.AspNetRoles r
					ON ur.RoleId = r.Id
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:01:32.714 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:01:32.732 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:01:32.784 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:01:32.897 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:01:32.968 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:01:33.331 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:01:33.790 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:01:33.801 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:01:33.961 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:01:33.966 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:05:07.008 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:05:20.817 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:05:27.651 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:05:27.966 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:05:27.972 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:05:27.990 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.022 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.036 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.064 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.069 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.072 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:05:28.073 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:05:28.087 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:05:28.100 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:05:28.117 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:05:28.164 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:05:28.203 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:05:28.234 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:05:28.235 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:05:28.238 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:05:28.240 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:05:28.245 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:05:28.249 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:05:28.253 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:05:28.255 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:05:28.257 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:05:28.259 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:05:28.265 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:05:28.271 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:05:28.283 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.341 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.407 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.410 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.435 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.436 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.439 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.442 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.445 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.456 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.462 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.467 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:05:34.471 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:05:34.477 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:05:34.481 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:05:34.490 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:05:34.493 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:05:34.515 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:05:34.519 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:05:34.521 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:05:34.522 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:05:34.523 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:05:34.526 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:05:34.530 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:05:34.532 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:05:34.533 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:05:34.534 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:05:34.537 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:05:34.538 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:05:34.544 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:05:34.550 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.552 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.618 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.620 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.657 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.659 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.662 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.667 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.675 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.689 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.702 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.710 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:05:34.711 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:05:34.715 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:05:34.716 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:05:34.719 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:05:34.721 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:05:34.748 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:05:34.752 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:05:34.754 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:05:34.755 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:05:34.758 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:05:34.760 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:05:34.766 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:05:34.768 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:05:34.771 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:05:34.772 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:05:34.774 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:05:34.775 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:05:34.781 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:05:34.825 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:05:35.070 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:05:35.094 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:05:36.117 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:05:36.120 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:05:36.121 -04:00 [INF] Hosting environment: Development
2020-08-26 08:05:36.122 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:20:00.728 -04:00 [INF] Starting host...
2020-08-26 08:20:02.318 -04:00 [INF] Migrating Database...
2020-08-26 08:20:03.339 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:20:03.761 -04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:06.834 -04:00 [INF] Executed DbCommand (3,006ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:20:06.872 -04:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:20:17.173 -04:00 [INF] Executed DbCommand (263ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:20:17.242 -04:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:20:17.251 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:17.397 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:20:17.403 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:17.429 -04:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:20:17.441 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:20:17.479 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:20:17.613 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:20:17.619 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:20:17.631 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:20:17.644 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:20:17.654 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.659 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.670 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.679 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.688 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.693 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.702 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.710 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.716 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.723 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.733 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.738 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.745 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.754 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.765 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.771 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.781 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:17.788 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:20:17.792 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:20:17.799 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:20:17.803 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:20:17.809 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:20:17.814 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:20:17.818 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:20:17.823 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:20:17.828 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:20:17.836 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:20:17.843 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:20:17.846 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:20:17.853 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:20:17.856 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:20:17.861 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:20:17.865 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:20:17.868 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:20:17.874 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:20:17.877 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:20:17.881 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:20:17.886 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:20:17.890 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:20:17.929 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:20:17.938 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:17.964 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:20:17.977 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:17.988 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:20:18.004 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:20:18.018 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:20:18.040 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:20:18.061 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:20:18.083 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:20:18.087 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:20:18.091 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:20:18.096 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:20:18.100 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:20:18.104 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:20:18.270 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:20:18.275 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:18.278 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:20:18.285 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:20:18.288 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:20:18.298 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:20:18.301 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:20:18.399 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:20:18.404 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:20:18.408 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:20:18.418 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:20:18.427 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:20:18.439 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:20:18.453 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:18.459 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:18.472 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:18.479 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:18.488 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:20:18.502 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:20:18.506 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:20:18.512 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:20:18.515 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:20:18.520 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:20:18.525 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:20:18.530 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:20:18.535 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:20:18.544 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:20:18.558 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:20:18.571 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:20:18.578 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:20:18.588 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:20:18.596 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:20:18.605 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:20:18.612 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:20:18.622 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:20:18.627 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:20:18.632 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:20:18.636 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:20:18.642 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:20:18.650 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
				INNER JOIN dbo.AspNetUserRoles ur
					ON ur.UserId = u.Id
				INNER JOIN dbo.AspNetRoles r
					ON ur.RoleId = r.Id
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:20:18.674 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:20:18.696 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:20:18.752 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:20:18.883 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:20:18.952 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:20:19.317 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:20:19.760 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:20:19.769 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:20:19.929 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:20:19.937 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:20:19.939 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.118 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.131 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.432 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.439 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.449 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.484 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.495 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.524 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.528 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.529 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:20:20.531 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:20:20.538 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:20:20.552 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:20:20.564 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:20:20.616 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:20:20.657 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:20:20.686 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:20:20.688 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:20:20.690 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:20:20.691 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:20:20.697 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:20:20.701 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:20:20.705 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:20:20.708 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:20:20.710 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:20:20.712 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:20:20.718 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:20:20.722 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:20:20.728 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.730 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.762 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.764 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.773 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.774 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.775 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.778 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.779 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.783 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.786 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.788 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:20:20.789 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:20:20.793 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:20:20.794 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:20:20.798 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:20:20.799 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:20:20.803 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:20:20.806 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:20:20.807 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:20:20.808 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:20:20.811 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:20:20.812 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:20:20.818 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:20:20.821 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:20:20.822 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:20:20.823 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:20:20.826 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:20:20.827 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:20:20.832 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:20:20.835 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.838 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.869 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.871 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.879 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.881 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.886 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.889 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.891 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.894 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.897 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.902 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:20:20.903 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:20:20.905 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:20:20.907 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:20:20.908 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:20:20.911 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:20:20.920 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:20:20.928 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:20:20.933 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:20:20.934 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:20:20.936 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:20:20.936 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:20:20.942 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:20:20.943 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:20:20.944 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:20:20.945 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:20:20.947 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:20:20.948 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:20:20.955 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:20:20.988 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:20:21.119 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:20:21.143 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:20:21.642 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:20:21.645 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:20:21.646 -04:00 [INF] Hosting environment: Development
2020-08-26 08:20:21.647 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:32:20.351 -04:00 [INF] Starting host...
2020-08-26 08:32:21.797 -04:00 [INF] Migrating Database...
2020-08-26 08:32:22.853 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:32:23.260 -04:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:26.333 -04:00 [INF] Executed DbCommand (3,006ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:32:26.367 -04:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:32:36.623 -04:00 [INF] Executed DbCommand (217ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:32:36.700 -04:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:32:36.709 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:36.880 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:32:36.886 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:36.918 -04:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:32:36.929 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:32:36.977 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:32:37.115 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.121 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.134 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.148 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.159 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.170 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.177 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.190 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.195 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.205 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.213 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.222 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.227 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.237 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.246 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.253 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.259 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.274 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.283 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.293 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.303 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.310 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:32:37.314 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:32:37.320 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:32:37.324 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:32:37.328 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:32:37.334 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:32:37.343 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:32:37.346 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:32:37.354 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:32:37.357 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:32:37.362 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:32:37.368 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:32:37.375 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:32:37.379 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:32:37.388 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:32:37.392 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:32:37.395 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:32:37.404 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:32:37.407 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:32:37.411 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:32:37.416 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:32:37.424 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:32:37.493 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:32:37.497 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:37.510 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:32:37.521 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:37.532 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:32:37.544 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:32:37.558 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:32:37.576 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:32:37.584 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:32:37.593 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:32:37.596 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:32:37.602 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:32:37.606 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:32:37.611 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:32:37.615 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:32:37.788 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:32:37.793 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:37.797 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:32:37.804 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:32:37.808 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:32:37.817 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:32:37.825 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:32:37.924 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:32:37.929 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:32:37.935 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:32:37.942 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:32:37.954 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.963 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:32:37.975 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.983 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:37.990 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:38.003 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:38.015 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:32:38.027 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:32:38.034 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:32:38.037 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:32:38.043 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:32:38.047 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:32:38.054 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:32:38.057 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:32:38.062 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:32:38.069 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:32:38.081 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:32:38.095 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:32:38.103 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:32:38.110 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:32:38.118 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:32:38.125 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:32:38.129 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:32:38.139 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:32:38.146 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:32:38.152 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:32:38.155 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:32:38.159 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:32:38.169 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
				INNER JOIN dbo.AspNetUserRoles ur
					ON ur.UserId = u.Id
				INNER JOIN dbo.AspNetRoles r
					ON ur.RoleId = r.Id
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:32:38.188 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:32:38.204 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:32:38.265 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:32:38.384 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:32:38.452 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:32:38.819 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:32:39.295 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:32:39.304 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:32:39.477 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:32:39.484 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:32:39.487 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:32:39.662 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:32:39.675 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:32:39.980 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:32:39.990 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.003 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.044 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.057 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.086 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.089 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.091 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:32:40.092 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:32:40.099 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:32:40.112 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:32:40.126 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:32:40.173 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:32:40.213 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:32:40.245 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:32:40.247 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:32:40.252 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:32:40.254 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:32:40.259 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:32:40.263 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:32:40.269 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:32:40.270 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:32:40.273 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:32:40.274 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:32:40.279 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:32:40.284 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:32:40.290 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.292 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.325 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.327 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.337 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.338 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.340 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.342 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.344 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.350 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.362 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.369 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:32:40.370 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:32:40.375 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:32:40.377 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:32:40.380 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:32:40.382 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:32:40.388 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:32:40.390 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:32:40.392 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:32:40.392 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:32:40.394 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:32:40.395 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:32:40.404 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:32:40.406 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:32:40.409 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:32:40.410 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:32:40.412 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:32:40.413 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:32:40.420 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:32:40.425 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.427 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.458 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.460 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.471 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.472 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.474 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.477 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.480 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.483 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.487 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.491 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:32:40.492 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:32:40.494 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:32:40.495 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:32:40.500 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:32:40.500 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:32:40.505 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:32:40.506 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:32:40.509 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:32:40.511 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:32:40.512 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:32:40.513 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:32:40.517 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:32:40.520 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:32:40.522 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:32:40.522 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:32:40.524 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:32:40.525 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:32:40.531 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:32:40.566 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:32:40.697 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:32:40.723 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:32:41.266 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:32:41.269 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:32:41.270 -04:00 [INF] Hosting environment: Development
2020-08-26 08:32:41.272 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:34:07.902 -04:00 [INF] Starting host...
2020-08-26 08:34:09.543 -04:00 [INF] Migrating Database...
2020-08-26 08:34:10.608 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:34:11.109 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:11.183 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:34:11.220 -04:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:34:21.518 -04:00 [INF] Executed DbCommand (261ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:34:21.606 -04:00 [INF] Executed DbCommand (85ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:34:21.698 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:21.849 -04:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:34:21.855 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:21.883 -04:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:34:21.894 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:34:21.941 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:34:22.094 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:34:22.101 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:34:22.115 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:34:22.141 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:34:22.163 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.173 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.178 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.195 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.209 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.227 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.234 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.245 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.256 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.270 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.283 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.340 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.381 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.403 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.430 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.453 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.459 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:22.466 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:34:22.472 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:34:22.476 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:34:22.479 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:34:22.484 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:34:22.488 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:34:22.494 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:34:22.498 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:34:22.504 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:34:22.507 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:34:22.510 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:34:22.516 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:34:22.524 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:34:22.528 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:34:22.532 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:34:22.537 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:34:22.542 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:34:22.547 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:34:22.551 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:34:22.557 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:34:22.561 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:34:22.569 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:34:22.617 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:34:22.621 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:22.623 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:34:22.626 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:22.631 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:34:22.638 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:34:22.643 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:34:22.659 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:34:22.666 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:34:22.675 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:34:22.678 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:34:22.685 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:34:22.688 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:34:22.693 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:34:22.697 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:34:22.872 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:34:22.876 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:22.879 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:34:22.885 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:34:22.888 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:34:22.893 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:34:22.899 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:34:22.990 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:34:22.995 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:34:23.000 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:34:23.009 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:34:23.017 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:34:23.024 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:34:23.033 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:23.041 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:23.053 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:23.065 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:23.074 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:34:23.082 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:34:23.088 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:34:23.092 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:34:23.098 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:34:23.103 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:34:23.108 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:34:23.112 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:34:23.119 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:34:23.127 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:34:23.141 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:34:23.150 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:34:23.158 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:34:23.168 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:34:23.186 -04:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:34:23.193 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:34:23.209 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:34:23.228 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:34:23.239 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:34:23.244 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:34:23.247 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:34:23.256 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:34:23.267 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
				INNER JOIN dbo.AspNetUserRoles ur
					ON ur.UserId = u.Id
				INNER JOIN dbo.AspNetRoles r
					ON ur.RoleId = r.Id
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:34:23.291 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:34:23.307 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:34:23.362 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:34:23.484 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:34:23.552 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:34:23.933 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:34:24.378 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:34:24.388 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:34:24.574 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:34:24.578 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:34:24.580 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:34:24.763 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:34:24.778 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.078 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.086 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.099 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.137 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.149 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.183 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.187 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.189 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:34:25.190 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:34:25.198 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:34:25.213 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:34:25.229 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:34:25.277 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:34:25.317 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:34:25.347 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:34:25.349 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:34:25.351 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:34:25.353 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:34:25.359 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:34:25.362 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:34:25.368 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:34:25.371 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:34:25.373 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:34:25.375 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:34:25.380 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:34:25.385 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:34:25.393 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.394 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.429 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.431 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.441 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.442 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.444 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.446 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.448 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.454 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.456 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.459 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:34:25.461 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:34:25.466 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:34:25.467 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:34:25.471 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:34:25.472 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:34:25.475 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:34:25.478 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:34:25.479 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:34:25.482 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:34:25.483 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:34:25.485 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:34:25.489 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:34:25.493 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:34:25.494 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:34:25.495 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:34:25.498 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:34:25.501 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:34:25.505 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:34:25.508 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.511 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.541 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.543 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.553 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.554 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.556 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.558 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.559 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.565 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.569 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.572 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:34:25.573 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:34:25.575 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:34:25.576 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:34:25.578 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:34:25.578 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:34:25.583 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:34:25.586 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:34:25.588 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:34:25.589 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:34:25.590 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:34:25.591 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:34:25.598 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:34:25.600 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:34:25.601 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:34:25.604 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:34:25.608 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:34:25.609 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:34:25.612 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:34:25.618 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 08:34:32.507 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:34:32.641 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:34:32.665 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:34:33.196 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:34:33.200 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:34:33.202 -04:00 [INF] Hosting environment: Development
2020-08-26 08:34:33.203 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:39:40.086 -04:00 [INF] Starting host...
2020-08-26 08:39:41.601 -04:00 [INF] Migrating Database...
2020-08-26 08:39:42.649 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:39:43.126 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:43.195 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:39:43.227 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:39:53.543 -04:00 [INF] Executed DbCommand (277ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:39:53.614 -04:00 [INF] Executed DbCommand (68ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:39:53.624 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:53.774 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:39:53.779 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:53.807 -04:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:39:53.817 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:39:53.855 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:39:53.988 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:39:53.994 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:39:54.006 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:39:54.022 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:39:54.032 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.042 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.051 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.059 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.065 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.075 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.090 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.099 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.110 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.121 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.129 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.139 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.145 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.151 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.161 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.172 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.178 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.188 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:39:54.192 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:39:54.196 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:39:54.203 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:39:54.208 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:39:54.213 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:39:54.222 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:39:54.226 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:39:54.231 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:39:54.235 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:39:54.240 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:39:54.243 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:39:54.247 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:39:54.253 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:39:54.256 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:39:54.262 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:39:54.266 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:39:54.272 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:39:54.275 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:39:54.282 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:39:54.286 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:39:54.294 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:39:54.361 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:39:54.365 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:54.377 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:39:54.388 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:54.400 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:39:54.413 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:39:54.428 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:39:54.445 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:39:54.454 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:39:54.460 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:39:54.464 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:39:54.471 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:39:54.475 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:39:54.481 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:39:54.484 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:39:54.648 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:39:54.652 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:54.657 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:39:54.663 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:39:54.668 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:39:54.676 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:39:54.680 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:39:54.793 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:39:54.797 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:39:54.803 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:39:54.812 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:39:54.820 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:39:54.826 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:39:54.838 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.849 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.860 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.873 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.885 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:39:54.893 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:39:54.897 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:39:54.904 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:39:54.907 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:39:54.912 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:39:54.919 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:39:54.928 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:39:54.940 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:39:54.952 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:39:54.975 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:39:54.991 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:39:54.999 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:39:55.004 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:39:55.015 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:39:55.024 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:39:55.030 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:39:55.039 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:39:55.045 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:39:55.053 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:39:55.057 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:39:55.061 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:39:55.072 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:39:55.095 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:39:55.119 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:39:55.190 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:39:55.333 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:39:55.403 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:39:55.784 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:39:56.218 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:39:56.227 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:39:56.386 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:39:56.390 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.393 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.560 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.573 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.860 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.869 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.879 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.916 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.928 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.954 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.957 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.959 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:39:56.960 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:39:56.969 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:39:56.983 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:39:56.995 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:39:57.040 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:39:57.077 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:39:57.124 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:39:57.125 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:39:57.128 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:39:57.129 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:39:57.134 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:39:57.139 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:39:57.144 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:39:57.147 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:39:57.152 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:39:57.154 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:39:57.160 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:39:57.164 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:39:57.170 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.172 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.206 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.208 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.217 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.218 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.220 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.222 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.223 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.228 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.230 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.233 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:39:57.234 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:39:57.239 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:39:57.240 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:39:57.244 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:39:57.248 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:39:57.253 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:39:57.255 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:39:57.258 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:39:57.259 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:39:57.262 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:39:57.263 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:39:57.268 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:39:57.270 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:39:57.271 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:39:57.273 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:39:57.275 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:39:57.276 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:39:57.285 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:39:57.288 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.291 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.323 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.325 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.334 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.335 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.337 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.339 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.341 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.346 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.349 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.352 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:39:57.353 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:39:57.355 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:39:57.356 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:39:57.357 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:39:57.358 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:39:57.362 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:39:57.365 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:39:57.366 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:39:57.370 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:39:57.371 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:39:57.374 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:39:57.378 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:39:57.380 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:39:57.382 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:39:57.382 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:39:57.387 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:39:57.387 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:39:57.392 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:39:57.394 -04:00 [INF] **Finished Loading Configurations.
2020-08-26 08:39:57.398 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 08:40:03.644 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:40:03.773 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:40:03.797 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:40:04.324 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:40:04.327 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:40:04.328 -04:00 [INF] Hosting environment: Development
2020-08-26 08:40:04.329 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:50:40.633 -04:00 [INF] Starting host...
2020-08-26 08:50:42.278 -04:00 [INF] Migrating Database...
2020-08-26 08:50:43.455 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:50:43.962 -04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:44.032 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:50:44.064 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:50:54.351 -04:00 [INF] Executed DbCommand (251ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:50:54.426 -04:00 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:50:54.436 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:54.583 -04:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:50:54.588 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:54.615 -04:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:50:54.628 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:50:54.668 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:50:54.804 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:50:54.813 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:50:54.824 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:50:54.835 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:50:54.845 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.850 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.858 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.869 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.877 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.884 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.890 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.895 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.907 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.913 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.924 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.935 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.941 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.949 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.958 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.966 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.972 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:54.980 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:50:54.984 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:50:54.988 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:50:54.993 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:50:54.996 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:50:55.002 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:50:55.006 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:50:55.016 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:50:55.023 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:50:55.028 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:50:55.034 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:50:55.039 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:50:55.044 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:50:55.048 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:50:55.054 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:50:55.059 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:50:55.066 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:50:55.074 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:50:55.078 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:50:55.085 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:50:55.091 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:50:55.097 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:50:55.140 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:50:55.168 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:55.183 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:50:55.192 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:55.205 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:50:55.219 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:50:55.230 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:50:55.252 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:50:55.263 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:50:55.272 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:50:55.275 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:50:55.282 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:50:55.286 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:50:55.291 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:50:55.295 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:50:55.470 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:50:55.474 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:55.478 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:50:55.486 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:50:55.490 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:50:55.497 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:50:55.501 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:50:55.595 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:50:55.600 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:50:55.613 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:50:55.622 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:50:55.628 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:50:55.638 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:50:55.647 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:55.658 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:55.665 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:55.674 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:55.685 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:50:55.692 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:50:55.696 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:50:55.703 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:50:55.707 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:50:55.715 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:50:55.719 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:50:55.726 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:50:55.730 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:50:55.738 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:50:55.751 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:50:55.758 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:50:55.764 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:50:55.771 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:50:55.779 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:50:55.787 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:50:55.796 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:50:55.806 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:50:55.812 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:50:55.822 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:50:55.828 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:50:55.831 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:50:55.842 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:50:55.860 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:50:55.881 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:50:55.940 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:50:56.058 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:50:56.126 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:50:56.487 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:50:56.950 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:50:56.960 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:50:57.122 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:50:57.129 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.132 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.305 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.320 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.614 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.622 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.631 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.672 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.684 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.709 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.712 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.716 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:50:57.717 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:50:57.728 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:50:57.740 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:50:57.754 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:50:57.799 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:50:57.837 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:50:57.866 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:50:57.868 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:50:57.870 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:50:57.871 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:50:57.876 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:50:57.880 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:50:57.885 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:50:57.888 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:50:57.893 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:50:57.894 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:50:57.902 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:50:57.905 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:50:57.914 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:57.916 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:57.951 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:57.953 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.007 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.008 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.010 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.013 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.014 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.017 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.021 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.023 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:50:58.025 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:50:58.029 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:50:58.030 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:50:58.033 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:50:58.034 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:50:58.038 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:50:58.041 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:50:58.042 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:50:58.043 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:50:58.046 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:50:58.047 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:50:58.051 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:50:58.053 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:50:58.055 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:50:58.055 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:50:58.057 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:50:58.062 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:50:58.065 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:50:58.071 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.072 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.104 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.106 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.120 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.122 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.123 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.128 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.129 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.134 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.138 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.140 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:50:58.141 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:50:58.143 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:50:58.145 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:50:58.147 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:50:58.148 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:50:58.153 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:50:58.158 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:50:58.159 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:50:58.160 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:50:58.162 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:50:58.162 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:50:58.169 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:50:58.172 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:50:58.173 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:50:58.174 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:50:58.176 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:50:58.179 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:50:58.185 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:50:58.188 -04:00 [INF] **Finished Loading Configurations.
2020-08-26 08:50:58.193 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 08:50:58.287 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:50:58.418 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:50:58.440 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:50:58.942 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:50:58.945 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:50:58.946 -04:00 [INF] Hosting environment: Development
2020-08-26 08:50:58.947 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 08:56:08.666 -04:00 [INF] Starting host...
2020-08-26 08:56:10.546 -04:00 [INF] Migrating Database...
2020-08-26 08:56:11.593 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:56:12.085 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:12.155 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 08:56:12.188 -04:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 08:56:22.425 -04:00 [INF] Executed DbCommand (199ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 08:56:22.505 -04:00 [INF] Executed DbCommand (78ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 08:56:22.514 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:22.645 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 08:56:22.649 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:22.676 -04:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:56:22.687 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:56:22.725 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 08:56:22.859 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 08:56:22.865 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 08:56:22.876 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 08:56:22.891 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 08:56:22.902 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.907 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.913 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.925 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.938 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.947 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.954 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.960 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.972 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.980 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.987 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:22.995 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.002 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.008 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.016 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.026 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.040 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.047 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 08:56:23.053 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 08:56:23.059 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 08:56:23.066 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 08:56:23.070 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 08:56:23.077 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 08:56:23.082 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 08:56:23.091 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 08:56:23.100 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 08:56:23.107 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 08:56:23.112 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 08:56:23.117 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 08:56:23.122 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 08:56:23.126 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 08:56:23.133 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 08:56:23.136 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 08:56:23.143 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 08:56:23.147 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 08:56:23.154 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 08:56:23.158 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 08:56:23.161 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 08:56:23.170 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 08:56:23.209 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:56:23.218 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:23.223 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:56:23.225 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:23.232 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:56:23.241 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:56:23.248 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 08:56:23.282 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 08:56:23.302 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 08:56:23.324 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 08:56:23.336 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 08:56:23.347 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 08:56:23.358 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 08:56:23.371 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 08:56:23.380 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 08:56:23.555 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 08:56:23.559 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:23.562 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:56:23.568 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 08:56:23.570 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 08:56:23.575 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 08:56:23.581 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 08:56:23.672 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:56:23.676 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 08:56:23.682 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 08:56:23.690 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 08:56:23.699 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 08:56:23.705 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 08:56:23.714 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.723 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.730 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.739 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.748 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 08:56:23.755 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 08:56:23.758 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 08:56:23.765 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 08:56:23.769 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 08:56:23.774 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 08:56:23.778 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 08:56:23.783 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 08:56:23.789 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 08:56:23.800 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 08:56:23.811 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 08:56:23.819 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 08:56:23.826 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 08:56:23.834 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 08:56:23.840 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 08:56:23.847 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 08:56:23.852 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 08:56:23.859 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 08:56:23.867 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 08:56:23.873 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 08:56:23.880 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 08:56:23.885 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 08:56:23.895 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 08:56:23.920 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 08:56:23.939 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 08:56:23.995 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 08:56:24.136 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 08:56:24.208 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 08:56:24.579 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 08:56:25.025 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 08:56:25.035 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 08:56:25.210 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 08:56:25.215 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.219 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.395 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.409 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.704 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.710 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.718 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.750 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.762 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.788 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.791 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.793 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 08:56:25.794 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:56:25.801 -04:00 [INF] 			Adding Organization a.test record for admin1@.test ...
2020-08-26 08:56:25.813 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:56:25.825 -04:00 [INF] 			Adding user record for admin1@.test ...
2020-08-26 08:56:25.869 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:56:25.908 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:56:25.936 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:56:25.938 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 08:56:25.940 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:56:25.941 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 08:56:25.946 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:56:25.951 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:56:25.955 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:56:25.958 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 08:56:25.960 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:56:25.961 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 08:56:25.965 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:56:25.970 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:56:25.983 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:25.984 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.019 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.021 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.076 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.079 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.082 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.085 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.089 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.094 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.097 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.102 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 08:56:26.103 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:56:26.108 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:56:26.111 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:56:26.117 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:56:26.117 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:56:26.124 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:56:26.126 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:56:26.127 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:56:26.128 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:56:26.130 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:56:26.133 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:56:26.138 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:56:26.139 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:56:26.140 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:56:26.143 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:56:26.145 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:56:26.146 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:56:26.150 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:56:26.162 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.164 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.194 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.196 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.212 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.213 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.217 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.220 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.221 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.227 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.230 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.233 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 08:56:26.236 -04:00 [INF] 			Checking organization record for admin1@.test ...
2020-08-26 08:56:26.238 -04:00 [INF] 			Organization a.test record found for admin1@.test ...
2020-08-26 08:56:26.238 -04:00 [INF] 			Checking user record for admin1@.test ...
2020-08-26 08:56:26.241 -04:00 [INF] 			User record found for admin1@.test ...
2020-08-26 08:56:26.241 -04:00 [INF] 			Checking user role records for admin1@.test ...
2020-08-26 08:56:26.250 -04:00 [INF] 			Checking claim records for admin1@.test ...
2020-08-26 08:56:26.252 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 08:56:26.253 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 08:56:26.254 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 08:56:26.261 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 08:56:26.262 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 08:56:26.267 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 08:56:26.271 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 08:56:26.273 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 08:56:26.275 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 08:56:26.278 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 08:56:26.283 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 08:56:26.290 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 08:56:26.303 -04:00 [INF] **Finished Loading Configurations.
2020-08-26 08:56:26.306 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 08:56:26.397 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 08:56:26.527 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 08:56:26.552 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 08:56:27.059 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 08:56:27.064 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 08:56:27.088 -04:00 [INF] Hosting environment: Development
2020-08-26 08:56:27.091 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 12:40:16.412 -04:00 [INF] Starting host...
2020-08-26 12:40:18.479 -04:00 [INF] Migrating Database...
2020-08-26 12:40:19.532 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 12:40:19.958 -04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:23.030 -04:00 [INF] Executed DbCommand (3,006ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 12:40:23.062 -04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 12:40:33.294 -04:00 [INF] Executed DbCommand (192ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 12:40:33.364 -04:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 12:40:33.373 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:33.515 -04:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 12:40:33.521 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:33.549 -04:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 12:40:33.560 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 12:40:33.598 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 12:40:33.730 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 12:40:33.737 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 12:40:33.748 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 12:40:33.758 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 12:40:33.767 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.773 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.780 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.793 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.799 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.805 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.813 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.821 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.829 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.834 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.842 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.850 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.858 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.864 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.875 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.882 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.888 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:33.894 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 12:40:33.897 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 12:40:33.905 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 12:40:33.911 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 12:40:33.914 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 12:40:33.917 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 12:40:33.927 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 12:40:33.932 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 12:40:33.937 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 12:40:33.943 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 12:40:33.946 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 12:40:33.952 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 12:40:33.956 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 12:40:33.959 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 12:40:33.965 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 12:40:33.971 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 12:40:33.978 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 12:40:33.985 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 12:40:33.990 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 12:40:33.995 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 12:40:33.998 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 12:40:34.003 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 12:40:34.040 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 12:40:34.047 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:34.051 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 12:40:34.056 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:34.059 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 12:40:34.066 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 12:40:34.072 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 12:40:34.089 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 12:40:34.095 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 12:40:34.102 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 12:40:34.107 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 12:40:34.115 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 12:40:34.124 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 12:40:34.128 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 12:40:34.136 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 12:40:34.355 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 12:40:34.363 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:34.372 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 12:40:34.378 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 12:40:34.382 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 12:40:34.392 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 12:40:34.397 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 12:40:34.556 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 12:40:34.561 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 12:40:34.566 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 12:40:34.575 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 12:40:34.583 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 12:40:34.596 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 12:40:34.610 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:34.620 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:34.627 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:34.634 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:34.644 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 12:40:34.654 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 12:40:34.658 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 12:40:34.666 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 12:40:34.672 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 12:40:34.676 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 12:40:34.679 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 12:40:34.684 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 12:40:34.689 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 12:40:34.697 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 12:40:34.709 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 12:40:34.720 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 12:40:34.727 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 12:40:34.731 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 12:40:34.739 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 12:40:34.746 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 12:40:34.752 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 12:40:34.759 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 12:40:34.765 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 12:40:34.770 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 12:40:34.774 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 12:40:34.777 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 12:40:34.784 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 12:40:34.800 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 12:40:34.824 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 12:40:34.889 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 12:40:35.023 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 12:40:35.093 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 12:40:35.449 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 12:40:35.911 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 12:40:35.919 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 12:40:36.075 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 12:40:36.085 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.090 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.259 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.273 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.556 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.564 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.574 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.612 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.625 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.649 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.652 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.654 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 12:40:36.655 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 12:40:36.662 -04:00 [INF] 			Adding Organization a.test record for maria@a.test ...
2020-08-26 12:40:36.674 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 12:40:36.685 -04:00 [INF] 			Adding user record for maria@a.test ...
2020-08-26 12:40:36.728 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 12:40:36.765 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 12:40:36.795 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 12:40:36.797 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 12:40:36.800 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 12:40:36.802 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 12:40:36.809 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 12:40:36.813 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 12:40:36.817 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 12:40:36.819 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 12:40:36.822 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 12:40:36.823 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 12:40:36.828 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 12:40:36.831 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 12:40:36.843 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.845 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.877 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.879 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.933 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.935 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.937 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.940 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.942 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.944 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.947 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.949 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 12:40:36.950 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 12:40:36.954 -04:00 [INF] 			Organization a.test record found for maria@a.test ...
2020-08-26 12:40:36.955 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 12:40:36.959 -04:00 [INF] 			User record found for maria@a.test ...
2020-08-26 12:40:36.960 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 12:40:36.964 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 12:40:36.966 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 12:40:36.968 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 12:40:36.969 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 12:40:36.971 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 12:40:36.972 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 12:40:36.977 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 12:40:36.978 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 12:40:36.980 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 12:40:36.981 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 12:40:36.986 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 12:40:36.987 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 12:40:36.994 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 12:40:37.000 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.002 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.043 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.046 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.061 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.062 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.065 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.067 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.069 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.072 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.075 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.077 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 12:40:37.078 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 12:40:37.080 -04:00 [INF] 			Organization a.test record found for maria@a.test ...
2020-08-26 12:40:37.081 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 12:40:37.084 -04:00 [INF] 			User record found for maria@a.test ...
2020-08-26 12:40:37.084 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 12:40:37.090 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 12:40:37.094 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 12:40:37.095 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 12:40:37.097 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 12:40:37.099 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 12:40:37.103 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 12:40:37.108 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 12:40:37.110 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 12:40:37.113 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 12:40:37.114 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 12:40:37.115 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 12:40:37.116 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 12:40:37.120 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 12:40:37.122 -04:00 [INF] **Finished Loading Configurations.
2020-08-26 12:40:37.125 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 12:40:37.204 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 12:40:37.364 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 12:40:37.387 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 12:40:37.982 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 12:40:37.984 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 12:40:37.986 -04:00 [INF] Hosting environment: Development
2020-08-26 12:40:37.987 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 12:40:42.978 -04:00 [INF] Application is shutting down...
2020-08-26 15:58:03.377 -04:00 [INF] Starting host...
2020-08-26 15:58:04.986 -04:00 [INF] Migrating Database...
2020-08-26 15:58:06.000 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'ConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 15:58:06.411 -04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:09.476 -04:00 [INF] Executed DbCommand (3,006ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2020-08-26 15:58:09.507 -04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [AspNetIdentityServer];
2020-08-26 15:58:19.786 -04:00 [INF] Executed DbCommand (241ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [AspNetIdentityServer];
2020-08-26 15:58:19.861 -04:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [AspNetIdentityServer] SET READ_COMMITTED_SNAPSHOT ON;
END;
2020-08-26 15:58:19.870 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.012 -04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2020-08-26 15:58:20.017 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.046 -04:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 15:58:20.057 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 15:58:20.101 -04:00 [INF] Applying migration '20200818143842_Initial'.
2020-08-26 15:58:20.239 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [AllowedAccessTokenSigningAlgorithms] nvarchar(100) NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_ApiResources] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.244 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopes] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    CONSTRAINT [PK_ApiScopes] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.251 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Clients] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [ProtocolType] nvarchar(200) NOT NULL,
    [RequireClientSecret] bit NOT NULL,
    [ClientName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [ClientUri] nvarchar(2000) NULL,
    [LogoUri] nvarchar(2000) NULL,
    [RequireConsent] bit NOT NULL,
    [AllowRememberConsent] bit NOT NULL,
    [AlwaysIncludeUserClaimsInIdToken] bit NOT NULL,
    [RequirePkce] bit NOT NULL,
    [AllowPlainTextPkce] bit NOT NULL,
    [RequireRequestObject] bit NOT NULL,
    [AllowAccessTokensViaBrowser] bit NOT NULL,
    [FrontChannelLogoutUri] nvarchar(2000) NULL,
    [FrontChannelLogoutSessionRequired] bit NOT NULL,
    [BackChannelLogoutUri] nvarchar(2000) NULL,
    [BackChannelLogoutSessionRequired] bit NOT NULL,
    [AllowOfflineAccess] bit NOT NULL,
    [IdentityTokenLifetime] int NOT NULL,
    [AllowedIdentityTokenSigningAlgorithms] nvarchar(100) NULL,
    [AccessTokenLifetime] int NOT NULL,
    [AuthorizationCodeLifetime] int NOT NULL,
    [ConsentLifetime] int NULL,
    [AbsoluteRefreshTokenLifetime] int NOT NULL,
    [SlidingRefreshTokenLifetime] int NOT NULL,
    [RefreshTokenUsage] int NOT NULL,
    [UpdateAccessTokenClaimsOnRefresh] bit NOT NULL,
    [RefreshTokenExpiration] int NOT NULL,
    [AccessTokenType] int NOT NULL,
    [EnableLocalLogin] bit NOT NULL,
    [IncludeJwtId] bit NOT NULL,
    [AlwaysSendClientClaims] bit NOT NULL,
    [ClientClaimsPrefix] nvarchar(200) NULL,
    [PairWiseSubjectSalt] nvarchar(200) NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [LastAccessed] datetime2 NULL,
    [UserSsoLifetime] int NULL,
    [UserCodeType] nvarchar(100) NULL,
    [DeviceCodeLifetime] int NOT NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_Clients] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.260 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResources] (
    [Id] int NOT NULL IDENTITY,
    [Enabled] bit NOT NULL,
    [Name] nvarchar(200) NOT NULL,
    [DisplayName] nvarchar(200) NULL,
    [Description] nvarchar(1000) NULL,
    [Required] bit NOT NULL,
    [Emphasize] bit NOT NULL,
    [ShowInDiscoveryDocument] bit NOT NULL,
    [Created] datetime2 NOT NULL,
    [Updated] datetime2 NULL,
    [NonEditable] bit NOT NULL,
    CONSTRAINT [PK_IdentityResources] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.266 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceClaims_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.273 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceProperties_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.280 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceScopes_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.287 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiResourceSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(1000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ApiResourceId] int NOT NULL,
    CONSTRAINT [PK_ApiResourceSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiResourceSecrets_ApiResources_ApiResourceId] FOREIGN KEY ([ApiResourceId]) REFERENCES [ApiResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.292 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeClaims_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.298 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ApiScopeProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ScopeId] int NOT NULL,
    CONSTRAINT [PK_ApiScopeProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ApiScopeProperties_ApiScopes_ScopeId] FOREIGN KEY ([ScopeId]) REFERENCES [ApiScopes] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.305 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(250) NOT NULL,
    [Value] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientClaims_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.311 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientCorsOrigins] (
    [Id] int NOT NULL IDENTITY,
    [Origin] nvarchar(150) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientCorsOrigins] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientCorsOrigins_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.317 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientGrantTypes] (
    [Id] int NOT NULL IDENTITY,
    [GrantType] nvarchar(250) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientGrantTypes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientGrantTypes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.327 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientIdPRestrictions] (
    [Id] int NOT NULL IDENTITY,
    [Provider] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientIdPRestrictions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientIdPRestrictions_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.334 -04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientPostLogoutRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [PostLogoutRedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientPostLogoutRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientPostLogoutRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.340 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientProperties_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.347 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientRedirectUris] (
    [Id] int NOT NULL IDENTITY,
    [RedirectUri] nvarchar(2000) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientRedirectUris] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientRedirectUris_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.354 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientScopes] (
    [Id] int NOT NULL IDENTITY,
    [Scope] nvarchar(200) NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientScopes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientScopes_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.360 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ClientSecrets] (
    [Id] int NOT NULL IDENTITY,
    [Description] nvarchar(2000) NULL,
    [Value] nvarchar(4000) NOT NULL,
    [Expiration] datetime2 NULL,
    [Type] nvarchar(250) NOT NULL,
    [Created] datetime2 NOT NULL,
    [ClientId] int NOT NULL,
    CONSTRAINT [PK_ClientSecrets] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ClientSecrets_Clients_ClientId] FOREIGN KEY ([ClientId]) REFERENCES [Clients] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.366 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceClaims] (
    [Id] int NOT NULL IDENTITY,
    [Type] nvarchar(200) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceClaims_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.372 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [IdentityResourceProperties] (
    [Id] int NOT NULL IDENTITY,
    [Key] nvarchar(250) NOT NULL,
    [Value] nvarchar(2000) NOT NULL,
    [IdentityResourceId] int NOT NULL,
    CONSTRAINT [PK_IdentityResourceProperties] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_IdentityResourceProperties_IdentityResources_IdentityResourceId] FOREIGN KEY ([IdentityResourceId]) REFERENCES [IdentityResources] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.377 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceClaims_ApiResourceId] ON [ApiResourceClaims] ([ApiResourceId]);
2020-08-26 15:58:20.380 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceProperties_ApiResourceId] ON [ApiResourceProperties] ([ApiResourceId]);
2020-08-26 15:58:20.383 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiResources_Name] ON [ApiResources] ([Name]);
2020-08-26 15:58:20.386 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceScopes_ApiResourceId] ON [ApiResourceScopes] ([ApiResourceId]);
2020-08-26 15:58:20.389 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiResourceSecrets_ApiResourceId] ON [ApiResourceSecrets] ([ApiResourceId]);
2020-08-26 15:58:20.393 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeClaims_ScopeId] ON [ApiScopeClaims] ([ScopeId]);
2020-08-26 15:58:20.397 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ApiScopeProperties_ScopeId] ON [ApiScopeProperties] ([ScopeId]);
2020-08-26 15:58:20.400 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_ApiScopes_Name] ON [ApiScopes] ([Name]);
2020-08-26 15:58:20.404 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientClaims_ClientId] ON [ClientClaims] ([ClientId]);
2020-08-26 15:58:20.407 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientCorsOrigins_ClientId] ON [ClientCorsOrigins] ([ClientId]);
2020-08-26 15:58:20.410 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientGrantTypes_ClientId] ON [ClientGrantTypes] ([ClientId]);
2020-08-26 15:58:20.413 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientIdPRestrictions_ClientId] ON [ClientIdPRestrictions] ([ClientId]);
2020-08-26 15:58:20.416 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientPostLogoutRedirectUris_ClientId] ON [ClientPostLogoutRedirectUris] ([ClientId]);
2020-08-26 15:58:20.421 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientProperties_ClientId] ON [ClientProperties] ([ClientId]);
2020-08-26 15:58:20.424 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientRedirectUris_ClientId] ON [ClientRedirectUris] ([ClientId]);
2020-08-26 15:58:20.429 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Clients_ClientId] ON [Clients] ([ClientId]);
2020-08-26 15:58:20.434 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientScopes_ClientId] ON [ClientScopes] ([ClientId]);
2020-08-26 15:58:20.439 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ClientSecrets_ClientId] ON [ClientSecrets] ([ClientId]);
2020-08-26 15:58:20.444 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceClaims_IdentityResourceId] ON [IdentityResourceClaims] ([IdentityResourceId]);
2020-08-26 15:58:20.447 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_IdentityResourceProperties_IdentityResourceId] ON [IdentityResourceProperties] ([IdentityResourceId]);
2020-08-26 15:58:20.452 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_IdentityResources_Name] ON [IdentityResources] ([Name]);
2020-08-26 15:58:20.457 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818143842_Initial', N'3.1.7');
2020-08-26 15:58:20.501 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 15:58:20.505 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.509 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 15:58:20.512 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.518 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 15:58:20.533 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 15:58:20.543 -04:00 [INF] Applying migration '20200818144238_Initial'.
2020-08-26 15:58:20.561 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DeviceCodes] (
    [UserCode] nvarchar(200) NOT NULL,
    [DeviceCode] nvarchar(200) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NOT NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_DeviceCodes] PRIMARY KEY ([UserCode])
);
2020-08-26 15:58:20.567 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [SessionId] nvarchar(100) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [Description] nvarchar(200) NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [ConsumedTime] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
2020-08-26 15:58:20.584 -04:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_DeviceCodes_DeviceCode] ON [DeviceCodes] ([DeviceCode]);
2020-08-26 15:58:20.595 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DeviceCodes_Expiration] ON [DeviceCodes] ([Expiration]);
2020-08-26 15:58:20.605 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_Expiration] ON [PersistedGrants] ([Expiration]);
2020-08-26 15:58:20.613 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
2020-08-26 15:58:20.618 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PersistedGrants_SubjectId_SessionId_Type] ON [PersistedGrants] ([SubjectId], [SessionId], [Type]);
2020-08-26 15:58:20.624 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818144238_Initial', N'3.1.7');
2020-08-26 15:58:20.812 -04:00 [INF] Entity Framework Core 3.1.7 initialized 'DomainIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=EDennis.AspNetIdentityServer 
2020-08-26 15:58:20.817 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.821 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 15:58:20.825 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2020-08-26 15:58:20.829 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2020-08-26 15:58:20.835 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2020-08-26 15:58:20.839 -04:00 [INF] Applying migration '20200818165611_Initial'.
2020-08-26 15:58:20.928 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetApplications] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 15:58:20.942 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE SEQUENCE [seqAspNetOrganizations] AS int START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE NO CYCLE;
2020-08-26 15:58:20.947 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetApplications] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetApplications),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetApplications] PRIMARY KEY ([Name])
);
2020-08-26 15:58:20.956 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetOrganizations] (
    [Name] varchar(200) NOT NULL DEFAULT (next value for seqAspNetOrganizations),
    [SysUser] nvarchar(150) NULL,
    [SysStatus] tinyint NOT NULL DEFAULT CAST(0 AS tinyint),
    CONSTRAINT [PK_AspNetOrganizations] PRIMARY KEY ([Name])
);
2020-08-26 15:58:20.968 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [Application] varchar(200) NOT NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.982 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    [LockoutEnabled] bit NOT NULL,
    [LockoutBegin] datetimeoffset NULL,
    [LockoutEnd] datetimeoffset NULL,
    [Organization] varchar(200) NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2020-08-26 15:58:20.994 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:20.999 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:21.006 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:21.015 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] int NOT NULL,
    [RoleId] int NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:21.023 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] int NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2020-08-26 15:58:21.031 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2020-08-26 15:58:21.037 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AspNetRoles_Application_Name] ON [AspNetRoles] ([Application], [Name]) WHERE [Application] IS NOT NULL AND [Name] IS NOT NULL;
2020-08-26 15:58:21.042 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2020-08-26 15:58:21.047 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2020-08-26 15:58:21.054 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2020-08-26 15:58:21.061 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2020-08-26 15:58:21.068 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2020-08-26 15:58:21.081 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetApplicationsView as
	select a.Name Application,

	JSON_QUERY('[' +
		STUFF((
			SELECT ',' + char(34) + r.Name + char(34) 
				FROM dbo.AspNetRoles r
				WHERE r.[Application] = a.Name
				FOR XML PATH('')),1,1,'') + ']' ) as Roles

	from dbo.AspNetApplications a
2020-08-26 15:58:21.089 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view AspNetUsersView as
	select u.Id, u.UserName, u.NormalizedUserName, u.Email NormalizedEmail, u.EmailConfirmed, u.PhoneNumber, u.PhoneNumberConfirmed,
	u.TwoFactorEnabled, u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.AccessFailedCount,
	u.Organization,

	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ApplicationName + char(34) + ':[' + RoleNames + ']' 
				FROM (
					SELECT a.Name ApplicationName,
						STUFF((
							SELECT ',' + char(34) + r.Name + char(34) 
								FROM dbo.AspNetRoles r
								INNER JOIN dbo.AspNetUserRoles ur
									ON ur.RoleId = r.Id
								WHERE u.Id = ur.UserId
									AND r.[Application] = a.Name
								FOR XML PATH('')),1,1,'') as RoleNames
						FROM dbo.AspNetApplications a
						GROUP BY a.Name
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as RolesDictionary,
	JSON_QUERY('{' 
		+ STUFF((
			SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
				FROM (
					SELECT uc2.ClaimType,
						STUFF((
							SELECT ',' + char(34) + uc.ClaimValue + char(34) 
								FROM dbo.AspNetUserClaims uc
								WHERE u.Id = uc.UserId
									and uc.ClaimType = uc2.ClaimType
								FOR XML PATH('')),1,1,'') as ClaimValues
						FROM dbo.AspNetUserClaims uc2
						GROUP BY uc2.ClaimType
						) stf
				FOR XML PATH('')),1,1,'') + '}' ) as ClaimsDictionary

	
	from dbo.AspNetUsers u
2020-08-26 15:58:21.097 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view ClientApplications
	with schemabinding as 
	select c.ClientId, ar.Name [Application] 
		from dbo.ApiResources ar
        inner join dbo.ClientScopes cs
            on cs.Scope = ar.Name
        inner join dbo.Clients c
            on cs.ClientId = c.Id;
2020-08-26 15:58:21.106 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_ClientApplications
		on ClientApplications(ClientId,[Application]);
2020-08-26 15:58:21.111 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_ClientApplications_AppName
		on ClientApplications([Application]);
2020-08-26 15:58:21.116 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserApplicationRoles
	with schemabinding as 
	select u.Id UserId, r.[Application], r.Name [Role] 
		from dbo.AspNetUsers u
        inner join dbo.AspNetUserRoles ur
			on ur.UserId = u.Id
		inner join dbo.AspNetRoles r
			on ur.RoleId = r.Id
2020-08-26 15:58:21.126 -04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create unique clustered index 
	ucidx_UserApplicationRoles
		on UserApplicationRoles(UserId,[Application],[Role]);
2020-08-26 15:58:21.131 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create nonclustered index
	idx_UserApplicationRoles_AppName
		on UserApplicationRoles([Application]);
2020-08-26 15:58:21.135 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
create view UserClientApplicationRoles
	as
	select uar.UserId, ca.ClientId, uar.[Application], uar.[Role]
		from UserApplicationRoles uar
		inner join ClientApplications ca
			on uar.[Application] = ca.[Application]
2020-08-26 15:58:21.140 -04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetRoles
	ADD CONSTRAINT fk_RolesApplications
		FOREIGN KEY ([Application])
			REFERENCES AspNetApplications (Name)
				ON DELETE CASCADE
2020-08-26 15:58:21.144 -04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE AspNetUsers
	ADD CONSTRAINT fk_UsersOrganizations
		FOREIGN KEY (Organization)
			REFERENCES AspNetOrganizations (Name)
				ON DELETE SET NULL
2020-08-26 15:58:21.147 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
USE [AspNetIdentityServer]
2020-08-26 15:58:21.152 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
/****** Object:  View [dbo].[DbDump]    Script Date: 8/18/2020 1:18:52 PM ******/
SET ANSI_NULLS ON
2020-08-26 15:58:21.156 -04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SET QUOTED_IDENTIFIER ON
2020-08-26 15:58:21.165 -04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE OR ALTER VIEW [dbo].[DbView] AS
SELECT('{' + STUFF((
SELECT 
	JSON_QUERY(
		STUFF((
			SELECT ar.Name,
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ApiResourceScopes s WHERE s.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('[' + stuff((SELECT ', "' + c.Type + '"' FROM ApiResourceClaims c WHERE c.ApiResourceId = ar.Id FOR XML PATH('')),1,1,'') + ']') Claims
				FROM ApiResources ar
				FOR JSON PATH),1,1,'')) ApiResources,
	JSON_QUERY('[' + 
		STUFF((
			SELECT c.ClientId, c.RequireConsent, c.RequirePkce, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.ClientClaimsPrefix,
				JSON_QUERY('[' + stuff((SELECT ', "' + g.GrantType + '"' FROM ClientGrantTypes g WHERE g.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') GrantTypes,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.RedirectUri + '"' FROM ClientRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') RedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + u.PostLogoutRedirectUri + '"' FROM ClientPostLogoutRedirectUris u WHERE u.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') PostLogoutRedirectUris,	
				JSON_QUERY('[' + stuff((SELECT ', "' + s.Scope + '"' FROM ClientScopes s WHERE s.ClientId = c.Id FOR XML PATH('')),1,1,'') + ']') Scopes,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + Type + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT cc2.Type,
									STUFF((
										SELECT ',' + char(34) + cc.Value + char(34) 
											FROM ClientClaims cc
											WHERE cc.ClientId = c.Id
												AND cc.Type = cc2.Type
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM ClientClaims cc2
									GROUP BY cc2.Type
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
				FROM Clients c
				FOR JSON PATH),1,1,'')
				+ ']') Clients,
	JSON_QUERY('[' +
		STUFF((
			SELECT u.Id, u.UserName, u.Email, u.EmailConfirmed, u.PhoneNumber, 
				u.LockoutBegin, u.LockoutEnd, u.LockoutEnabled, u.Organization,  
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + [Application] + char(34) + ':[' + RoleNames + ']' 
							FROM (
								SELECT a.Name [Application],
									STUFF((
										SELECT ',' + char(34) + r.Name + char(34) 
											FROM dbo.AspNetRoles r
											INNER JOIN dbo.AspNetUserRoles ur
												ON ur.RoleId = r.Id
											WHERE u.Id = ur.UserId
												AND r.Application = a.Name
											FOR XML PATH('')),1,1,'') as RoleNames
									FROM dbo.AspNetApplications a
									GROUP BY a.Name
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Roles,
				JSON_QUERY('{' 
					+ STUFF((
						SELECT ',' + char(34) + ClaimType + char(34) + ':[' + ClaimValues + ']' 
							FROM (
								SELECT uc2.ClaimType,
									STUFF((
										SELECT ',' + char(34) + uc.ClaimValue + char(34) 
											FROM dbo.AspNetUserClaims uc
											WHERE u.Id = uc.UserId
												and uc.ClaimType = uc2.ClaimType
											FOR XML PATH('')),1,1,'') as ClaimValues
									FROM dbo.AspNetUserClaims uc2
									GROUP BY uc2.ClaimType
									) stf
							FOR XML PATH('')),1,1,'') + '}' ) as Claims
	
				FROM dbo.AspNetUsers u
	
				FOR JSON PATH),1,1,'')
								+ ']') Users
	FOR JSON PATH, WITHOUT_ARRAY_WRAPPER
),1,1,'')) as json
2020-08-26 15:58:21.189 -04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20200818165611_Initial', N'3.1.7');
2020-08-26 15:58:21.206 -04:00 [INF] Creating DomainIdentityDbContext instance ...
2020-08-26 15:58:21.266 -04:00 [INF] Creating ConfigurationDbContext instance ...
2020-08-26 15:58:21.386 -04:00 [INF] Creating PersistedGrantDbContext instance ...
2020-08-26 15:58:21.453 -04:00 [INF] Loading Configs\IdentityResources.json ...
2020-08-26 15:58:21.816 -04:00 [INF] 	Adding IdentityResource openid
2020-08-26 15:58:22.287 -04:00 [INF] 	Adding IdentityResource profile
2020-08-26 15:58:22.297 -04:00 [INF] 	Adding IdentityResource role
2020-08-26 15:58:22.460 -04:00 [INF] Loading project configs from Configs ...
2020-08-26 15:58:22.464 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.468 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.654 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.671 -04:00 [INF] 		Loading EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.969 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.974 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApi ...
2020-08-26 15:58:22.983 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.015 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.026 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.052 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.054 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.056 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApi ...
2020-08-26 15:58:23.057 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 15:58:23.063 -04:00 [INF] 			Adding Organization a.test record for maria@a.test ...
2020-08-26 15:58:23.080 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 15:58:23.094 -04:00 [INF] 			Adding user record for maria@a.test ...
2020-08-26 15:58:23.134 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 15:58:23.166 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 15:58:23.195 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 15:58:23.197 -04:00 [INF] 			Adding Organization b.test record for darius@b.test ...
2020-08-26 15:58:23.198 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 15:58:23.200 -04:00 [INF] 			Adding user record for darius@b.test ...
2020-08-26 15:58:23.205 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 15:58:23.207 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 15:58:23.212 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 15:58:23.213 -04:00 [INF] 			Adding Organization c.test record for pat@c.test ...
2020-08-26 15:58:23.216 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 15:58:23.217 -04:00 [INF] 			Adding user record for pat@c.test ...
2020-08-26 15:58:23.222 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 15:58:23.225 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 15:58:23.237 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.239 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.283 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.287 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.354 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.355 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.360 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.364 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.370 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.380 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.389 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.394 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Razor ...
2020-08-26 15:58:23.395 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 15:58:23.400 -04:00 [INF] 			Organization a.test record found for maria@a.test ...
2020-08-26 15:58:23.402 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 15:58:23.412 -04:00 [INF] 			User record found for maria@a.test ...
2020-08-26 15:58:23.414 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 15:58:23.424 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 15:58:23.428 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 15:58:23.430 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 15:58:23.431 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 15:58:23.433 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 15:58:23.434 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 15:58:23.442 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 15:58:23.444 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 15:58:23.446 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 15:58:23.447 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 15:58:23.448 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 15:58:23.449 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 15:58:23.454 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 15:58:23.458 -04:00 [INF] 	Loading Apis for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.459 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.493 -04:00 [INF] 	Loading Clients for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.495 -04:00 [INF] 		Loading EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.536 -04:00 [INF] 	Loading TestUsers for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.537 -04:00 [INF] 		Checking application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.542 -04:00 [INF] 		Adding application record for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.546 -04:00 [INF] 		Checking role records for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.550 -04:00 [INF] 		Adding role Admin record for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.560 -04:00 [INF] 		Adding role User record for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.570 -04:00 [INF] 		Adding role Readonly record for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.576 -04:00 [INF] 		Checking test user records for EDennis.Samples.ColorApp.Server ...
2020-08-26 15:58:23.577 -04:00 [INF] 			Checking organization record for maria@a.test ...
2020-08-26 15:58:23.579 -04:00 [INF] 			Organization a.test record found for maria@a.test ...
2020-08-26 15:58:23.580 -04:00 [INF] 			Checking user record for maria@a.test ...
2020-08-26 15:58:23.582 -04:00 [INF] 			User record found for maria@a.test ...
2020-08-26 15:58:23.583 -04:00 [INF] 			Checking user role records for maria@a.test ...
2020-08-26 15:58:23.594 -04:00 [INF] 			Checking claim records for maria@a.test ...
2020-08-26 15:58:23.599 -04:00 [INF] 			Checking organization record for darius@b.test ...
2020-08-26 15:58:23.601 -04:00 [INF] 			Organization b.test record found for darius@b.test ...
2020-08-26 15:58:23.603 -04:00 [INF] 			Checking user record for darius@b.test ...
2020-08-26 15:58:23.606 -04:00 [INF] 			User record found for darius@b.test ...
2020-08-26 15:58:23.607 -04:00 [INF] 			Checking user role records for darius@b.test ...
2020-08-26 15:58:23.627 -04:00 [INF] 			Checking claim records for darius@b.test ...
2020-08-26 15:58:23.636 -04:00 [INF] 			Checking organization record for pat@c.test ...
2020-08-26 15:58:23.638 -04:00 [INF] 			Organization c.test record found for pat@c.test ...
2020-08-26 15:58:23.639 -04:00 [INF] 			Checking user record for pat@c.test ...
2020-08-26 15:58:23.642 -04:00 [INF] 			User record found for pat@c.test ...
2020-08-26 15:58:23.643 -04:00 [INF] 			Checking user role records for pat@c.test ...
2020-08-26 15:58:23.655 -04:00 [INF] 			Checking claim records for pat@c.test ...
2020-08-26 15:58:23.662 -04:00 [INF] **Finished Loading Configurations.
2020-08-26 15:58:23.664 -04:00 [INF] Dumping ApiResources, Clients, and Users to JSON file ...
2020-08-26 15:58:23.757 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 15:58:23.888 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 15:58:23.913 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 15:58:24.431 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 15:58:24.435 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 15:58:24.436 -04:00 [INF] Hosting environment: Development
2020-08-26 15:58:24.437 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
2020-08-26 16:08:15.689 -04:00 [INF] Starting host...
2020-08-26 16:08:17.429 -04:00 [INF] User profile is available. Using 'C:\Users\denmi\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-08-26 16:08:17.582 -04:00 [INF] Starting IdentityServer4 version 4.0.4+1b36d1b414f4e0f965af97ab2a7e9dd1b5167bca
2020-08-26 16:08:17.747 -04:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-08-26 16:08:18.289 -04:00 [INF] Now listening on: https://localhost:5000
2020-08-26 16:08:18.292 -04:00 [INF] Application started. Press Ctrl+C to shut down.
2020-08-26 16:08:18.293 -04:00 [INF] Hosting environment: Development
2020-08-26 16:08:18.295 -04:00 [INF] Content root path: C:\Users\denmi\source\repos\denmitchell\EDennis.AspNet.Base\EDennis.AspNetIdentityServer
